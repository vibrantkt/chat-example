webpackJsonp([1],{"/xny":function(e,t){},0:function(e,t){},"2Hmj":function(e,t){},K0Oj:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("//Fk"),o=n.n(s),a=n("7+uW"),c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"account"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.edit,expression:"!edit"}],staticClass:"name",on:{click:function(t){e.edit=!0}}},[e._v(e._s(e.$store.getters.myName&&e.$store.getters.myName.payload.name||e.$store.state.account.public))]),e._v(" "),n("input",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"},{name:"model",rawName:"v-model",value:e.newName,expression:"newName"}],staticClass:"name",attrs:{type:"text"},domProps:{value:e.newName},on:{change:e.changeName,input:function(t){t.target.composing||(e.newName=t.target.value)}}}),e._v(" "),n("span",[e._v("Address:")]),e._v(" "),n("div",{staticClass:"address"},[e._v(e._s(e.$store.state.account.public))])])},staticRenderFns:[]};var r=n("VU/8")({data:function(){return{newName:this.$store.getters.myName&&this.$store.getters.myName.payload.name||"New name",edit:!1}},name:"Account",methods:{changeName:function(){var e=this;this.$http.post("/command",{command:"account "+this.newName}).then(function(t){e.edit=!1})}}},c,!1,function(e){n("2Hmj")},null,null).exports,i={data:function(){return{remoteNode:"localhost:7001"}},methods:{connect:function(){var e=this;console.log("connectinh"),this.$http.post("/command",{command:"connect "+this.remoteNode}).then(function(t){e.$store.dispatch("fetchAccount")})}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"network"},[n("div",{staticClass:"info"},[n("div",[e._v("Blocks: "+e._s(e.$store.state.blockchain.blocks.length))])]),e._v(" "),n("table",{staticClass:"connected"},[e._m(0),e._v(" "),e._l(e.$store.state.account.peers,function(t){return n("tr",{key:JSON.stringify(t)},[n("td",[e._v(e._s(t.address)+":"+e._s(t.port))]),e._v(" "),n("td",[e._v(e._s(e.$store.state.account.miners.some(function(e){return e.address==t.address&&e.port==t.port})))])])})],2),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.remoteNode,expression:"remoteNode"}],attrs:{placeholder:"localhost:7001"},domProps:{value:e.remoteNode},on:{change:e.connect,input:function(t){t.target.composing||(e.remoteNode=t.target.value)}}}),e._v(" "),n("button",{on:{click:e.connect}},[e._v("Connect to node")])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("th",[e._v("Nodes")]),e._v(" "),n("th",[e._v("MINER")])])}]};var d=n("VU/8")(i,u,!1,function(e){n("po51")},null,null).exports,l={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"message",class:{mine:e.$store.state.account.public===e.message.from}},[e._v("\n    "+e._s(e.message.payload.content)+"\n")])},staticRenderFns:[]};var m={data:function(){return{selectedFriendAddress:this.$store.getters.friends.last()&&this.$store.getters.friends.last().address||null,friendAddress:"",messageText:""}},methods:{addFriend:function(){this.message("Hello!",this.friendAddress)},sendMessage:function(){this.message(this.messageText,this.selectedFriendAddress),this.messageText=""},message:function(e,t){this.$http.post("/command",{command:"transaction "+t+" "+e}).then(function(e){})}},updated:function(){var e=this.$el.querySelector(".messages-wrapper");e.scrollTop=e.scrollHeight},components:{Message:n("VU/8")({props:["message"]},l,!1,function(e){n("/xny")},null,null).exports}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat"},[n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[e._v("\n          Friends   \n      ")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.friendAddress,expression:"friendAddress"}],attrs:{placeholder:"Friend address",type:"text"},domProps:{value:e.friendAddress},on:{input:function(t){t.target.composing||(e.friendAddress=t.target.value)}}}),e._v(" "),n("div",{staticClass:"title button",on:{click:e.addFriend}},[e._v("\n          Add friend\n      ")]),e._v(" "),n("div",{staticClass:"friends-list"},e._l(e.$store.getters.friends,function(t){return n("div",{key:t.address,staticClass:"friend",class:{selected:t.address===e.selectedFriendAddress},on:{click:function(n){e.selectedFriendAddress=t.address}}},[e._v("\n          "+e._s(t.alias)+"\n      ")])}))]),e._v(" "),n("div",{staticClass:"body"},[n("div",{staticClass:"messages-wrapper"},[n("div",{staticClass:"title"},[e._v("\n          Messages\n          ")]),e._v(" "),e._l(e.$store.getters.messagesWith(e.selectedFriendAddress),function(e){return n("Message",{key:e.signature,attrs:{message:e}})})],2),e._v(" "),e.selectedFriendAddress?n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],staticClass:"message-text",domProps:{value:e.messageText},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.sendMessage(t)},input:function(t){t.target.composing||(e.messageText=t.target.value)}}}):e._e()])])},staticRenderFns:[]};var p={name:"App",data:function(){return{socket:null}},methods:{initSession:function(){var e=this,t=new WebSocket("ws://"+document.location.host+"/event");t.onopen=function(){console.log("Session ready")},t.onclose=function(e){console.log("Session closed")},t.onmessage=function(t){var n=JSON.parse(t.data);e.$store.commit("addBlock",n)},t.onerror=function(e){console.log("Error lul")},this.socket=t}},components:{Account:r,Network:d,Chat:n("VU/8")(m,f,!1,function(e){n("aKSW")},null,null).exports},mounted:function(){this.initSession()}},v={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("Account"),this._v(" "),t("Network"),this._v(" "),t("Chat")],1)},staticRenderFns:[]};var h=n("VU/8")(p,v,!1,function(e){n("K0Oj")},null,null).exports,g=n("NYxO");a.a.use(g.a),Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]});var _=new g.a.Store({state:{blockchain:{difficulty:0,blocks:[]},account:{public:"",miners:[],peers:[]}},mutations:{addBlock:function(e,t){e.blockchain.blocks.push(t)},setBlockChain:function(e,t){e.blockchain=t},setAccount:function(e,t){e.account=t}},getters:{accountName:function(e,t){return function(e){return t.transactions.filter(function(t){return"account-meta-data"===t.payload["@type"]&&t.from===e}).last()}},myName:function(e,t){return t.accountName(e.account.public)},friends:function(e,t){return t.transactions.filter(function(t){return"message"===t.payload["@type"]&&(t.from===e.account.public||t.to===e.account.public)}).map(function(n){var s=t.accountName(n.from===e.account.public&&n.to||n.from);return{address:n.from===e.account.public&&n.to||n.from,alias:s&&s.payload.name||n.from===e.account.public&&n.to||n.from}}).filter(function(e,t,n){return n.findIndex(function(t){return t.address===e.address})===t})},messagesWith:function(e,t){return function(n){return t.transactions.filter(function(t){return"message"===t.payload["@type"]&&(t.from===e.account.public&&t.to===n||t.to===e.account.public&&t.from===n)})}},transactions:function(e){return e.blockchain.blocks.map(function(e){return e.transactions}).reduce(function(e,t){return e.concat(t)},[])}},actions:{fetchAccount:function(e){var t=e.commit;fetch("/account").then(function(e){return e.json()}).then(function(e){t("setAccount",e)})}}}),N=n("8+8L");a.a.config.productionTip=!1,a.a.use(N.a);var y=fetch("/account").then(function(e){return e.json()}).then(function(e){_.commit("setAccount",e)}),k=fetch("/blockchain").then(function(e){return e.json()}).then(function(e){console.log(e),_.commit("setBlockChain",{difficulty:e.difficulty,blocks:e.blocks})});o.a.all([y,k]).then(function(e){new a.a({el:"#app",components:{App:h},store:_,template:"<App/>"})})},aKSW:function(e,t){},po51:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.a4bec15892a460e62e46.js.map